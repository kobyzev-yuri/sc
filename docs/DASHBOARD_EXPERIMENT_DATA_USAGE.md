# Использование данных из эксперимента в Dashboard

## Ответ на вопрос

**Да, можно использовать данные из эксперимента напрямую в dashboard!**

Если вы используете конфиг и данные эксперимента, загрузка из директории с JSON файлами **не нужна**.

---

## Когда использовать данные из эксперимента

### ✅ Используйте данные из эксперимента, когда:

1. **Хотите воспроизвести результаты эксперимента**
   - Используете те же данные, что были при подборе признаков
   - Не нужно пересчитывать агрегацию

2. **Работаете с медиками**
   - Показываете результаты конкретного эксперимента
   - Используете проверенные данные

3. **Сравниваете эксперименты**
   - Переключаетесь между разными экспериментами
   - Сравниваете результаты на одинаковых данных

### ⚠️ Используйте загрузку из директории, когда:

1. **Экспериментируете с новыми данными**
   - Добавили новые JSON файлы с предсказаниями
   - Хотите протестировать на других данных

2. **Изменили предсказания**
   - Обновили модели и пересоздали предсказания
   - Нужно пересчитать агрегацию

3. **Нет сохраненных данных в эксперименте**
   - Старые эксперименты могут не содержать CSV файлов
   - Нужно загрузить из JSON

---

## Как использовать данные из эксперимента

### В Dashboard:

1. **Выберите источник данных:**
   ```
   "Использовать данные из эксперимента"
   ```

2. **Выберите эксперимент:**
   - Появится список доступных экспериментов
   - Показаны score и метод каждого эксперимента
   - Выберите нужный эксперимент

3. **Данные загрузятся автоматически:**
   - ✅ Агрегированные данные (если есть)
   - ✅ Относительные признаки (если есть)
   - ✅ Все доступные признаки (если есть)

4. **JSON файлы НЕ загружаются:**
   - Используются сохраненные CSV файлы
   - Быстрее и надежнее

---

## Преимущества использования данных из эксперимента

### ✅ Скорость:
- Не нужно загружать и агрегировать JSON файлы
- Данные уже готовы к использованию

### ✅ Воспроизводимость:
- Используются те же данные, что при подборе признаков
- Гарантированная консистентность

### ✅ Удобство:
- Не нужно указывать путь к директории
- Все данные в одном месте

### ✅ Безопасность:
- Исходные эксперименты не изменяются
- Можно переключаться между экспериментами

---

## Структура данных в эксперименте

```
experiments/
└── feature_selection_quick/
    ├── aggregated_data_*.csv          ← Агрегированные данные
    ├── relative_features_*.csv        ← Относительные признаки
    ├── all_features_*.csv             ← Все доступные признаки
    ├── best_features_*.json          ← Конфигурация признаков
    └── scale/cfg/feature_selection_config_relative.json  ← Конфигурация для dashboard
```

**Dashboard использует:**
- `aggregated_data_*.csv` → `df` (агрегированные данные)
- `relative_features_*.csv` → `df_features_full` (относительные признаки)
- `all_features_*.csv` → `df_all_features` (все доступные признаки)

---

## Примеры использования

### Пример 1: Воспроизведение результатов эксперимента

```bash
# 1. Экспортировать эксперимент в dashboard
python3 -m scale.feature_selection_versioning_cli export feature_selection_quick

# 2. Запустить dashboard
streamlit run scale/dashboard.py

# 3. В dashboard:
#    - Выбрать "Использовать данные из эксперимента"
#    - Выбрать "feature_selection_quick"
#    - Данные загрузятся автоматически
#    - JSON файлы НЕ нужны!
```

### Пример 2: Сравнение экспериментов

```bash
# 1. Запустить dashboard
streamlit run scale/dashboard.py

# 2. В dashboard:
#    - Выбрать "Использовать данные из эксперимента"
#    - Выбрать первый эксперимент
#    - Проверить результаты
#    
#    - Выбрать второй эксперимент
#    - Сравнить результаты
#    
#    - Оба эксперимента используют свои сохраненные данные
```

### Пример 3: Работа с новыми данными

```bash
# 1. Запустить dashboard
streamlit run scale/dashboard.py

# 2. В dashboard:
#    - Выбрать "Использовать директорию"
#    - Указать путь к новым JSON файлам
#    - Данные загрузятся и агрегируются заново
```

---

## Что происходит при загрузке из эксперимента

1. **Dashboard ищет CSV файлы:**
   - `aggregated_data_*.csv` - агрегированные данные
   - `relative_features_*.csv` - относительные признаки
   - `all_features_*.csv` - все доступные признаки

2. **Загружает последние файлы:**
   - Если есть несколько версий, берется последняя (по timestamp)

3. **Использует данные напрямую:**
   - Не загружает JSON файлы
   - Не выполняет агрегацию
   - Использует готовые данные

4. **Применяет конфигурацию:**
   - Загружает признаки из `best_features_*.json`
   - Или использует конфигурацию из dashboard

---

## FAQ

### Q: Можно ли использовать данные из эксперимента без JSON файлов?

**A:** Да! Если в эксперименте сохранены CSV файлы с данными, JSON файлы не нужны.

### Q: Что если в эксперименте нет сохраненных данных?

**A:** Dashboard покажет предупреждение и предложит использовать "Использовать директорию" для загрузки из JSON.

### Q: Можно ли изменить данные в эксперименте?

**A:** Нет, исходные эксперименты защищены. Изменения сохраняются только в dashboard конфигурации.

### Q: Что если данные в эксперименте устарели?

**A:** Используйте "Использовать директорию" для загрузки свежих данных из JSON файлов.

---

## Рекомендации

### ✅ Используйте данные из эксперимента для:
- Презентаций медикам
- Воспроизведения результатов
- Сравнения экспериментов
- Демонстрации результатов

### ⚠️ Используйте загрузку из директории для:
- Тестирования новых данных
- Обновленных предсказаний
- Экспериментирования с данными

---

## Заключение

**Да, если используете конфиг и данные эксперимента, загрузка из директории не нужна!**

Dashboard может работать в двух режимах:
1. **Из эксперимента** - использует сохраненные данные (быстро, воспроизводимо)
2. **Из директории** - загружает и агрегирует JSON файлы (для новых данных)

Выбирайте режим в зависимости от задачи!


